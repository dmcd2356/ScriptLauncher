# ScriptLauncher
This program is meant to be a supplemental GUI interface to the _AmazonReader_ project to aid in debugging scripts that are written for that project. This runs as a separate entity that communicates with _AmazonReader_ when it is run with the -network option. This option causes _AmazonReader_ to act as a TCP server, waiting for commands to be sent from the network and executing them. This program, then acts as the client, making requests to the server, so we will be using the terminology of _server_ to refer to AmazonReader and _client_ to refer to this program. The interface between the programs uses TCP protocol and the server can be set to a specified port selection. It will initially set this value to the port selected by the user the last time the program was run (it is saved in the file .amazonreader/site.properties in the directory that ScriptLauncher is executed from. If this file is not found, it will default to port 6000. ScriptLauncher also has a site.properties file in the .scriptlauncher sub-directory of where it is executed from. It is used to hold the properties of this program that are saved from one program run to the next, such as the last port used by this program. Although the startup screen allows the user to specify another value to override it, it allows the user to close the program and re-run it later without having to remember the port specified by the server the last time.

**[CLIENT Messages Sent]**
The commands (ASCII text) that are sent from client to server are:

>**_LOAD <filename>_**	- loads a script into memory (where _<filename>_ is the name of the file to load)
>**_COMPILE_**	- compile the script
>**_RUN_**	- execute the script
>**_STOP_**	- stop the script (if it is running)
>**_PAUSE_**	- pause the execution (so it can be resumed)
>**_RESUME_**	- resume execution from the current point
>**_STEP_**	- execute the next line in the script
>**_RESET_**	- reset the program counter (next line to execute) to the begining
>**_BREAKPT <line>_**	- set a breakpoint in the script to stop execution when running (where _line>_ is a line number)
>**_DISCONNECT_**	- disconnect the TCP port from the server
>**_EXIT_**	- terminate the server

**[SERVER Responses Received]**
The responses sent back from the server are:

>**_STATUS: <state>_**	- a change of state in the server
>**_LINE: <line>_**	- the current line number
>**_SUBSTACK: <stack info>_**	- the current list of subroutine calls
>**_ALLOC: <variable info>_**	- each variable allocation created during compile
>**_VARMSG: <variable info>_**	- variables that have changed during script execution
>**_LOGMSG: <log info>_**	- debug log info (info the server also saves in log file)
>**_OUTPUT: <message>_**	- output generated by the script using the PRINT command

**[STATUS Response Format]**
This status value will be displayed in the Status text message location.

>**_CONNECTED_**	- the client has connected to the server
>**_DISCONNECTED_**	- the client has disconnected from the server
>**_LOADED_**	- the script file has completed loading
>**_COMPILED_**	- the script has completed compilation
>**_EOF_**	- the execution of the script has completed
>**_STOPPED_**	- the execution has stopped due to client request
>**_PAUSED_**	- the execution has paused due to client request
>**_STEPPED_**	- the execution has completed for the current line
>**_BREAK_**	- the execution has paused due to reaching the set breakpoint
>**_RESUMED_**	- the execution has resumed
>**_BREAKPT SET_**	- the breakpoint change has been accepted
>**_BREAKPT INVALID_**	- the breakpoint change was rejected (not a valid exacutable line)

>**[LINE Response Format]**
>The LINE entry is simple enough: it will be the line number of the script that is the next to be executed. If the end of the script has been reached, the value will be END.

>**[SUBSTACK Response Format]**

>_SUBSTACK: MAIN :: Subroutine1 :: Subroutine2_

>The current subroutine will be the furthest name on the right, and the caller of each subroutine listed preceeds it with a double colon seperating them. The leftmost entry will always be MAIN. This information is displayed in the Sub stack text message location.

>**[ALLOC Response Format]**

>_ALLOC: \[<name> VarName :: <type> String :: <owner> *MAIN*]_

>The entries are again seperated by a double colon and consist of an id tag followed by its corresponding value. The tags are: _<name>_, _<type>_, and _<owner>_, although _<owner>_ will be omitted for the RESERVED section. _<name>_ refers to the name of the variable, _<type>_ is the data type, and _<owner>_ is either MAIN or the subroutine in which the allocation was made. This is more important in LOCAL section variables, since they are only accessible to that subroutine. This information is formatted and displayed in the Variables tab.

>**[VARMSG Response Format]**
>This message is similar to ALLOC, but has additional fields. It has the following format:

>_VARMSG: \[<section> RESERVED :: <name> VarName :: <type> Integer :: <value> 32 :: <writer> FileStatusCheck :: <line> 166 :: <time> 00:00.000]_

>The additional sections here are _<section>_, to identify whether it is a _RESERVED_, _GLOBAL_, _LOCAL_ or _LOOP_ variable; _<value>_ which is the current value of the variable, _<writer>_ is the subroutine that wrote the value, _<line>_ is the line in the script that wrote the variable, and _<time>_ is the execution time when the value was written (same values that are used in the log messages, for reference). This information is also formatted and displayed in the Variables tab, with any variable changes indicated by marking the values in red.

>**[LOGMSG Response Format]**
>LOGMSG info consists of the debug information that is saved in the AmazonReader test log file. It has the format of:

>_LOGMSG: 00000664 00:00.062 \[PROG  ]:     Path selection: /home/user/Projects/AmazonLogger/logs_

>Where the 8-digit entry is a counter value (for reference), followed by the timestamp value in msec resolution as MM:SS.mmm, followed by the type, of debug message enclosed in square brackets, followed by the message itself. This information is displayed in the Debug log tab.

>**[OUTPUT Response Format]**
>OUTPUT info is simply the text output generated by the PRINT messages in the script. This information is displayed in the User Output tab.

**[Control Section]**
The top portion of the GUI contains the controls and some (hopefully, useful) status information. The controls are:

>**Connect / Disconnect** - used to connect (or disconnect) from the server. The text box to the right of it allows the user to set what TCP port to use, but it will have to match whatever port the server has been set to operate on.
>**Current State** - (not marked) it is the text displayed to the right of the port selection. It gives the user an idea of what state the program is in (e.g: CONNECTION, LOADING, COMPILING, RUNNING, etc.)

>**Load** - lets you select a script file to load. When selected, it will display it in the _Script_ tab and tell the server the selection, which will cause it to also load the file into its memory.

>**Compile** - This will tell the server to compile the script into an executable that can be run. All variable allocations are made during this compile stage. It also initializes the starting line where execution will take place.
>**Run / Stop / Reset** - this control is initially _Run_ and will tell the server to begin executing from the current location and the button will change to _Stop_. If the Stop button is pressed or the script completes execution, the button will then change to _Reset_ and the script next location will be at EOF (end of file), preventing the user from running any further. Pressing the _Reset_ button will tell the server to reset the program to the begining and will return the button to _Run_ state, so that it can be re-run (or stepped through) again.
>**Pause / Resume** - this allows the user to pause the script and then resume from where it left off.
>**Step** - this sends a massage to the server to execute just the next line of the script.

>**Breakpoints Enable / Disable** - the button will allow you to set or clear a line to cause the server to break execution when it gets to that line. The text box to the right of the button lets you specify the line to break on. Note that the server will terminate when it reaches the breakpoint, but hasn't executed it yet.

>**Terminate** - this sends a command to the server to tell it to exit. This will cause this client to disconnect, and it won't be able to re-connect until the server is restarted.

>**Status** - this will display various status conditions and errors that may be helpful in debugging.
>**Sub Stack** - this displays the current subroutine call list with MAIN being the leftmost entity, and each subroutine nesting indicated by a _->_ and the name of the subroutine.
>**Next Command** - this displays the next command to be executed and should match up with the line number that is highlighted in the _Script_ tab.

**[Tab Information]**

>**[Script]**
>This displays the contents of the current script that has been loaded in the server. It color codes different sections of code to make it easier to identify them. The program commands are displayed in _RED_, those commands that are valid through the command line interface (known as Command Options) are marked on _ORANGE_, variables and variable references are marked in _VIOLET_ and are italicized, comments are marked in _GREEN_ and are also italicized, and the rest of the code is marked in _BROWN_. The line numbers that are added to the left side are kept in _BLACK_.
>Also, the next line to be executed will have its line number displayed in _BLUE_, and if breakpoints are enabled, the line number of the breakpoint will be displayed in _RED_. If the next line to execute equals the breakpoint (such as when running and stops at the breakpoint), the line will be displayed in _VIOLET_.

>**[Variables]**
>This displays variables that are accessible to the script, and is broken into 4 groups, or sections.
>**LOOPS** is the list of currently available loop parameters that are created when a FOR command is used. These are always of _Integer_ data type.
>**RESERVED** is the list of predefined variables that the program changes based on specific commands that are executed.
>**GLOBALS** contains the user-defined variables of GLOBAL scope that are created with the _ALLOC_ command. These are accessible by all subroutines.
>**LOCALS** contains the user-defined variables of LOCAL scope that are created with the _ALLOC_ command. These are only accessible to the subroutine that created it.

>The categories that are displayed for the variables are:
>**Variable** - the name of the variable
>**Owner** - the subroutine (or MAIN) that did the allocation and is therefore the owner of it
>**Data type** - one of the data types: Integer, Unsigned, Boolean, String, StrArray, IntArray
>**Writer** - the subroutine (or MAIN) that last wrote to the variable
>**Line** - the line number in the script when the variable was written
>**Time** - the timestamp (used by _Debug log_ window) when the variable was written
>**Value** - the current value of the variable (note that StrArray and IntArray will enclose the array entries in square brackets and seperate the items with commas)

>For _Loops_ section, there are the following additional headings
>**Start** - the starting value of the loop
>**Stop** - the ending value of the loop
>**Step** - the step size used in the loop
>**Incl** - true if the _Stop_ value will execute prior to loop termination, false if it will terminate without executing the _Stop_ value
>**Comp** - the loop comparison used to determine when the loop terminates

>Each time the script is halted, whether it is due to hitting a breakpoint, halted by the user, completing the script, or single stepping the variables that have changed since the last stopped period will be highlighted by displaying them in _RED_.

>**[User Output]**
>This tab simply displays all the output from _PRINT_ statements used in the script.

>**[Debug log]**
>This displays all the debug information that is enabled by the _LOGFILE_ command in the script, which is performed in the _STARTUP_ section of the script. The messages are color-coded based on the type of debug message being displayed. Each entry will have a log counter value and timestamp associated with it for referencing it. The timestamp value is the time in minutes, seconds, and milliseconds since RUN was pressed, but the timer is paused during non-execution time (when stopped, paused, or after a step completes).

>**[Network Comm]**
>This displays all communication between the client and server with client messages displayed in _BLUE_ and server messages in _GREEN_. Additional status info is displayed in black.
